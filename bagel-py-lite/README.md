# bagel-py-lite

This is a minimal PoC implementation of the bagel file format, supporting only X25519 and Scrypt recipient types.

It's not ready to be used, the CLI interface needs work, and you should assume that it's cryptographically broken. That said, if you *do* see any broken-ness, please file an issue and I'll try to improve it.

Also, it depends on v40 of the `cryptography` package, which hasn't been released yet.

```
usage: bagel_lite_cli.py [-h] [-e | -d] [-o OUTPUT] [-p] [-r RECIPIENT] [-R PATH] [-i PATH] [INPUT]

positional arguments:
  INPUT

options:
  -h, --help            show this help message and exit
  -e, --encrypt         Encrypt the input to the output. Default if omitted.
  -d, --decrypt         Decrypt the input to the output.
  -o OUTPUT, --output OUTPUT
                        Write the result to the file at path OUTPUT.
  -p, --passphrase      Encrypt with a passphrase.
  -r RECIPIENT, --recipient RECIPIENT
                        Encrypt to the specified RECIPIENT. Can be repeated.
  -R PATH, --recipients PATH
                        Encrypt to recipients listed at PATH. Can be repeated.
  -i PATH, --identity PATH
                        Use the identity file at PATH. Can be repeated.

INPUT defaults to standard input, and OUTPUT defaults to standard output.
If OUTPUT exists, it will be overwritten.

RECIPIENT can be an age public key generated by age-keygen ("age1...").

Recipient files contain one or more recipients, one per line. Empty lines
and lines starting with "#" are ignored as comments. "-" may be used to
read recipients from standard input.

Identity files contain one or more secret keys ("AGE-SECRET-KEY-1..."),
one per line. Empty lines and lines starting with "#" are
ignored as comments. Multiple key files can be provided, and any unused ones
will be ignored. "-" may be used to read identities from standard input.

Example:
    $ age-keygen -o key.txt
    Public key: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
    $ tar cvz ~/data | ./bagel_lite_cli.py -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p > data.tar.gz.bagel
    $ ./bagel_lite_cli.py --decrypt -i key.txt -o data.tar.gz data.tar.gz.bagel
```
